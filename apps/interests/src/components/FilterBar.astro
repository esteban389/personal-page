---
interface Props {
  allTags: string[];
  allTypes: string[];
}

const { allTags, allTypes } = Astro.props;
const uniqueTags = [...new Set(allTags)].sort();
const uniqueTypes = [...new Set(allTypes)].sort();
---

<div class="filter-bar">
  <div class="filter-bar__status">
    <button class="filter-bar__button filter-bar__button--active" data-filter="status" data-value="all">
      All Interests
    </button>
    <button class="filter-bar__button" data-filter="status" data-value="current">
      Current
    </button>
    <button class="filter-bar__button" data-filter="status" data-value="past">
      Past
    </button>
  </div>

  {uniqueTypes.length > 0 && (
    <div class="filter-bar__type">
      <label for="type-filter" class="filter-bar__label">Filter by type:</label>
      <select id="type-filter" class="filter-bar__select" data-filter="type">
        <option value="all">All Types</option>
        {uniqueTypes.map((type) => (
          <option value={type}>{type.charAt(0).toUpperCase() + type.slice(1)}</option>
        ))}
      </select>
    </div>
  )}

  {uniqueTags.length > 0 && (
    <div class="filter-bar__tags">
      <div class="filter-bar__tags-header">
        <p class="filter-bar__label">Filter by tags:</p>
        <button class="filter-bar__all-tags-button" data-action="select-all-tags">
          All
        </button>
      </div>
      <div class="filter-bar__tags-list">
        {uniqueTags.map((tag) => (
          <label class="filter-bar__tag-label">
            <input 
              type="checkbox" 
              class="filter-bar__tag-checkbox" 
              data-filter="tag" 
              data-value={tag}
              checked
            />
            <span class="filter-bar__tag-text">{tag}</span>
          </label>
        ))}
      </div>
    </div>
  )}
</div>

<style>
  .filter-bar {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-lg);
  }

  .filter-bar__status {
    display: flex;
    justify-content: center;
    gap: var(--spacing-sm);
    flex-wrap: wrap;
  }

  .filter-bar__button {
    padding: var(--spacing-sm) var(--spacing-xl);
    font-size: var(--font-size-base);
    font-weight: var(--font-weight-medium);
    color: var(--color-text);
    background: var(--color-background);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: all var(--transition-base);
    font-family: var(--font-family-base);
  }

  .filter-bar__button:hover {
    background: var(--color-surface);
    border-color: var(--color-text-muted);
  }

  .filter-bar__button--active {
    background: var(--color-primary);
    color: var(--color-background);
    border-color: var(--color-primary);
  }

  .filter-bar__button--active:hover {
    background: var(--color-primary-hover);
    border-color: var(--color-primary-hover);
  }

  .filter-bar__tags {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-md);
  }

  .filter-bar__tags-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    gap: var(--spacing-sm);
  }

  .filter-bar__label {
    font-size: var(--font-size-sm);
    color: var(--color-text);
    font-weight: var(--font-weight-medium);
    margin: 0;
  }

  .filter-bar__all-tags-button {
    padding: var(--spacing-xs) var(--spacing-sm);
    font-size: var(--font-size-xs);
    font-weight: var(--font-weight-medium);
    color: var(--color-primary);
    background: transparent;
    border: 1px solid var(--color-primary);
    border-radius: var(--radius-sm);
    cursor: pointer;
    transition: all var(--transition-base);
    font-family: var(--font-family-base);
  }

  .filter-bar__all-tags-button:hover {
    background: var(--color-primary);
    color: var(--color-background);
  }

  .filter-bar__tags-list {
    display: flex;
    flex-wrap: wrap;
    gap: var(--spacing-sm);
  }

  .filter-bar__tag-label {
    display: flex;
    align-items: center;
    gap: var(--spacing-xs);
    cursor: pointer;
    padding: var(--spacing-xs) var(--spacing-md);
    background: var(--color-background);
    border: 1px solid var(--color-border-light);
    border-radius: var(--radius-full);
    transition: all var(--transition-base);
    user-select: none;
    white-space: nowrap;
  }

  .filter-bar__tag-label:hover {
    background: var(--color-surface);
    border-color: var(--color-text-muted);
  }

  .filter-bar__tag-checkbox {
    width: 1rem;
    height: 1rem;
    cursor: pointer;
    accent-color: var(--color-primary);
    flex-shrink: 0;
  }

  .filter-bar__tag-text {
    font-size: var(--font-size-sm);
    color: var(--color-text);
    font-weight: var(--font-weight-normal);
  }

  .filter-bar__type {
    display: flex;
    flex-direction: column;
    gap: var(--spacing-sm);
  }

  .filter-bar__select {
    padding: var(--spacing-sm) var(--spacing-md);
    font-size: var(--font-size-base);
    font-family: var(--font-family-base);
    color: var(--color-text);
    background: var(--color-background);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    cursor: pointer;
    transition: border-color var(--transition-base);
  }

  .filter-bar__select:focus {
    outline: none;
    border-color: var(--color-primary);
  }

  @media (min-width: 768px) {
    .filter-bar__status {
      gap: var(--spacing-md);
    }

    .filter-bar__tags-list {
      gap: var(--spacing-md);
    }

    .filter-bar__type {
      flex-direction: row;
      align-items: center;
      gap: var(--spacing-md);
    }

    .filter-bar__select {
      min-width: 200px;
    }
  }
</style>
